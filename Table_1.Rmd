---
title: "Table 1"
author: "Christopher Soria"
date: "2023-11-08"
output: html_document
---

```{r}
library(tidyverse)
library(dplyr)
library(kableExtra)
library(knitr)
```


```{r}
average_by_party <- df %>%
  group_by(political_party) %>%
  summarise(
    average_num_cc_nonhh = mean(num_cc_nonhh, na.rm = TRUE),
    average_contact_reduction = mean(contact_reduction, na.rm = TRUE),
    average_concern = mean(binary_concern_strong, na.rm = TRUE),
    average_mask_usage = mean(Norm_Masks_Used, na.rm = TRUE),
    average_safety_index = mean(Non_Weighted_Safety_Index, na.rm = TRUE),
    average_vaccinated = mean(Vaccinated, na.rm = TRUE)
  )

average_by_party_table <- t(as.data.frame(average_by_party))
average_by_party_table <- as.data.frame(average_by_party_table)
average_by_party_table <- average_by_party_table[-1, ]

for (col in 1:3) {
  average_by_party_table[, col] <- as.numeric(as.character(average_by_party_table[, col]))
}

average_by_party_table[, 1:3] <- round(average_by_party_table[, 1:3], digits = 3)

apt_row_names <- c("Non-Household Contacts", "Level of Stated Contact Reduction", "Concern About the Spread of the Virus", "Proportion of Contacts with a Mask", "Overall Safety During Contacts", "Proportion Vaccinated")
rownames(average_by_party_table) <- apt_row_names

kable_output <- kable(average_by_party_table, 
                      caption = "Table 1. Descriptive Outcomes by Political Party",
                      col.names = c("Democrat", "Independent", "Republican"),
                      align = c("l", "c", "l"))

# Add a horizontal line after the first row
kable_styled <- kable_output %>%
  kable_styling() %>%
  add_header_above(c(" " = 1, "Political Parties" = 3)) %>%  # Optional: Add a header above the column names
  pack_rows(index = c("Where Respondents Reported Raw Counts" = 1, "Where Closest to 1 is highest" = 5))

print(kable_styled)

rm(average_by_party)
```


