geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = c("Wave 2", "Wave 3", "Wave 4", "Wave 5", "Wave 6")) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
dates = c("June 18-24, '20", "September 12-20, '20'", "December 1-7, '20'","February 9-14, '21'","May 14-25, '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = dates) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
date = c("June 18-24, '20", "September 12-20, '20'", "December 1-7, '20'","February 9-14, '21'","May 14-25, '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = data_collected_dates, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = c("Wave 2", "Wave 3", "Wave 4", "Wave 5", "Wave 6")) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, data_collected_dates == "June 18-24, '20"))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
date = c("June 18-24, '20", "September 12-20, '20'", "December 1-7, '20'","February 9-14, '21'","May 14-25, '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = data_collected_dates, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = c("Wave 2", "Wave 3", "Wave 4", "Wave 5", "Wave 6")) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
date = c("June 18-24, '20", "September 12-20, '20'", "December 1-7, '20'","February 9-14, '21'","May 14-25, '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = data_collected_dates, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = c("Wave 2", "Wave 3", "Wave 4", "Wave 5", "Wave 6")) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
date = c("June 18-24, '20", "September 12-20, '20'", "December 1-7, '20'","February 9-14, '21'","May 14-25, '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = c("Wave 2", "Wave 3", "Wave 4", "Wave 5", "Wave 6")) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
dates = c("June '20", "September '20'", "December '20'","February '21'","May '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +  # Add shape mapping to aes()
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16),  # shapes for each wave =
labels = dates) +  # Custom labels for the legend
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +  # Label for the shape legend
theme_minimal() +
theme(legend.position = "bottom")  # Adjust legend position
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
dates = c("June '20", "September '20'", "December '20'","February '21'","May '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16), labels = dates) +
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +
theme_minimal() +
theme(legend.position = "bottom") +
geom_hline(yintercept = 1, linetype = "solid", color = "black")
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  COV_County_CMR_2020_06_20 + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
dates = c("June '20", "September '20'", "December '20'","February '21'","May '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16), labels = dates) +
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +
theme_minimal() +
theme(legend.position = "bottom") +
geom_hline(yintercept = 1, linetype = "solid", color = "darkgray")
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3 (September 12-20, '20')
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ `rate_prev_9/9/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4 (December 1-7, '20')
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  `rate_prev_12/1/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5 (February 9-14, '21')
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ `rate_prev_2/4/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 2 (June 18-24, '20)
contacts_R_v_D_w2 <- glm.nb(num_cc_nonhh ~  `rate_prev_6/14/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 2))
#model for Wave 3 (September 12-20, '20')
contacts_R_v_D_w3 <- glm.nb(num_cc_nonhh ~ `rate_prev_9/9/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 3))
# Model for Wave 4 (December 1-7, '20')
contacts_R_v_D_w4 <- glm.nb(num_cc_nonhh ~  `rate_prev_12/1/20` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 4))
#model for Wave 5 (February 9-14, '21')
contacts_R_v_D_w5 <- glm.nb(num_cc_nonhh ~ `rate_prev_2/4/21` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 5))
# Model for Wave 6 (May 14-25, '21')
contacts_R_v_D_w6 <- glm.nb(num_cc_nonhh ~  `rate_prev_5/12/21` + State_Government_Response_Index_11192020 + COUNT_RUCC_CAT + resp_sex + resp_educ + resp_yob + r_working + r_race + political_party, data = subset(df, wave == 6))
#function for extracting coeffs
extract_coefficient_and_error <- function(model, coefficient_name) {
estimate <- coef(summary(model))[coefficient_name, "Estimate"]
std_error <- coef(summary(model))[coefficient_name, "Std. Error"]
list(coefficient = exp(estimate),
lower = exp(estimate - 1.96 * std_error),
upper = exp(estimate + 1.96 * std_error))
}
coeff_wave2 <- extract_coefficient_and_error(contacts_R_v_D_w2, "political_partyRepublican")
coeff_wave3 <- extract_coefficient_and_error(contacts_R_v_D_w3, "political_partyRepublican")
coeff_wave4 <- extract_coefficient_and_error(contacts_R_v_D_w4, "political_partyRepublican")
coeff_wave5 <- extract_coefficient_and_error(contacts_R_v_D_w5, "political_partyRepublican")
coeff_wave6 <- extract_coefficient_and_error(contacts_R_v_D_w6, "political_partyRepublican")
# coef df
coefficients_df <- data.frame(
Wave = factor(c(2, 3, 4, 5, 6)),
Coefficient = c(coeff_wave2$coefficient, coeff_wave3$coefficient, coeff_wave4$coefficient, coeff_wave5$coefficient, coeff_wave6$coefficient),
Lower = c(coeff_wave2$lower, coeff_wave3$lower, coeff_wave4$lower, coeff_wave5$lower, coeff_wave6$lower),
Upper = c(coeff_wave2$upper, coeff_wave3$upper, coeff_wave4$upper, coeff_wave5$upper,coeff_wave6$upper)
)
dates = c("June '20", "September '20'", "December '20'","February '21'","May '21'")
contacts_R_v_D_plot <- ggplot(coefficients_df, aes(x = Wave, y = Coefficient, shape = Wave)) +
geom_point(position = position_dodge(width = 0.25), size = 5, color = "red") +
geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.1, position = position_dodge(width = 0.25), color = "red") +
scale_shape_manual(values = c(16, 16, 16, 16, 16), labels = dates) +
labs(title = "Wave-Specific Comparative Non-Household Contacts for Republicans During the Pandemic",
subtitle = "Reference: Democrats",
x = "Wave",
y = "IRR",
shape = "Wave Shapes") +
theme_minimal() +
theme(legend.position = "bottom") +
geom_hline(yintercept = 1, linetype = "solid", color = "darkgray")
print(summary(contacts_R_v_D_w2))
print(summary(contacts_R_v_D_w3))
print(summary(contacts_R_v_D_w4))
print(summary(contacts_R_v_D_w5))
print(summary(contacts_R_v_D_w6))
rm(coeff_wave1,coeff_wave2,coeff_wave3,contacts_R_v_D_w1,contacts_R_v_D_w2,contacts_R_v_D_w3)
# Print the plot
print(contacts_R_v_D_plot)
table(df$wave, df$fall2020_school_closures)
summarized_data <- df %>%
group_by(wave, fall2020_school_closures) %>%
summarise(count = n(), .groups = 'drop')
# Create a contingency table
contingency_table <- with(summarized_data, table(wave, fall2020_school_closures))
contingency_table
summarized_data <- df %>%
group_by(wave, fall2020_school_closures) %>%
summarise(count = n(), .groups = 'drop')
# Create a contingency table
contingency_table <- with(summarized_data, table(wave, fall2020_school_closures))
contingency_table
rm(contingency_table)
rm(summarized_data)
na_counts_by_wave <- df %>%
group_by(wave) %>%
summarise(na_count_fall = sum(is.na(fall2020_school_closures)), .groups = 'drop',
na_count_spring = sum(is.na(spring2021_school_closures)), .groups = 'drop')
na_counts_by_wave <- df %>%
group_by(wave) %>%
summarise(
na_count_fall = sum(is.na(fall2020_school_closures)),
na_count_spring = sum(is.na(spring2021_school_closures))
)
na_counts_by_wave
